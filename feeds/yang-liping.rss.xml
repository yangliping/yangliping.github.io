<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>Liping's Blog - Yang Liping</title><link>http://www.yanglp.com/</link><description>翁曰：「無他，但手熟爾。」</description><lastBuildDate>Fri, 08 May 2020 16:24:53 +0800</lastBuildDate><item><title>用gdb deubg bash输出不正常问题</title><link>http://www.yanglp.com/posts/2020/05/08/yong-gdb-deubg-bashshu-chu-bu-zheng-chang-wen-ti.html</link><description>&lt;p&gt;&lt;strong&gt;TL;DR&lt;/strong&gt; bash参数扩展导致命令输出跟预期结果不一致。&lt;/p&gt;
&lt;h2&gt;问题描述&lt;/h2&gt;
&lt;p&gt;用户反馈&lt;code&gt;echo&lt;/code&gt;或者&lt;code&gt;printf&lt;/code&gt;命令如下，当有1或者g的时候，只会输出1或/和g，没有其他数据，怀疑系统有问题。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;printf&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="n"&gt;jnrw&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;mvlewgtf09u23434e12ermld234r25cscfw&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="n"&gt;jnrw&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;mvlewgtf09u23434e12ermld234r25cscfw&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;

&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;adfaasdljfalsjljajzpqwekzv&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;adfaasdljfalsjljajzpqwekzv&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;uname&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;
&lt;span class="mf"&gt;2.6.32&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;504.16.2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;el6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;问题分析&lt;/h2&gt;
&lt;p&gt;使用&lt;code&gt;strace&lt;/code&gt;命令去跟踪，发现bash在执行execve系统调用的时候，传递给echo的就是只有1和g。问题应该在bash。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;# strace -f echo [aaag1bbb]&lt;/span&gt;
&lt;span class="n"&gt;execve …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yang Liping</dc:creator><pubDate>Fri, 08 May 2020 16:24:53 +0800</pubDate><guid isPermaLink="false">tag:www.yanglp.com,2020-05-08:/posts/2020/05/08/yong-gdb-deubg-bashshu-chu-bu-zheng-chang-wen-ti.html</guid><category>Tech</category><category>bash</category><category>linux</category><category>gdb</category></item><item><title>bash引用命令参数</title><link>http://www.yanglp.com/posts/2020/04/27/bashyin-yong-ming-ling-can-shu.html</link><description>&lt;h2&gt;&lt;code&gt;!-n&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;引用之前输入过的命令，比如&lt;code&gt;!-1&lt;/code&gt;代表上一个命令，&lt;code&gt;!-2&lt;/code&gt;代表上上个命令&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;hello world!&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;hello&lt;/span&gt; &lt;span class="n"&gt;world&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;cd&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="o"&gt;!-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;  &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="o"&gt;!-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;cd&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="o"&gt;!-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;hello world!&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;hello world&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;hello&lt;/span&gt; &lt;span class="n"&gt;world&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;!!&lt;/code&gt; 等价于&lt;code&gt;!-1&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;hello world!&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;hello&lt;/span&gt; &lt;span class="n"&gt;world&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="o"&gt;!!&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;hello world&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;hello&lt;/span&gt; &lt;span class="n"&gt;world&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;!!&lt;/code&gt; 在sudo的时候比较有用&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;vim&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;myfile&lt;/span&gt;
&lt;span class="nl"&gt;vim:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;myfile&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Permission&lt;/span&gt; &lt;span class="n"&gt;denied&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;sudo …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yang Liping</dc:creator><pubDate>Mon, 27 Apr 2020 17:59:32 +0800</pubDate><guid isPermaLink="false">tag:www.yanglp.com,2020-04-27:/posts/2020/04/27/bashyin-yong-ming-ling-can-shu.html</guid><category>Tech</category><category>bash</category><category>linux</category></item><item><title>python import sge库文件</title><link>http://www.yanglp.com/posts/2020/04/25/python-import-sgeku-wen-jian.html</link><description>&lt;p&gt;在python编程过程中，有些时候由于重用代码或者性能之类的原因，需要直接调用c语言写的库文件。python支持Cython、swig、ctypes、cffi等不同方式来调用c的代码。下面以ctypes为例，介绍怎么在python中使用sge的库文件。&lt;/p&gt;
&lt;p&gt;下载最新的Son of Grid Engine，链接https://gitlab.com/loveshack/sge (&lt;em&gt;注：本文档以9baeb84cdc883c4ba8b38cfc89ab8262e6d4e1d9这个commit的版本为例&lt;/em&gt;)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# tar zxf sge-master.tar.gz&lt;/span&gt;
&lt;span class="c"&gt;# cd sge-master/source&lt;/span&gt;
&lt;span class="c"&gt;# sh scripts/bootstrap.sh&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;根据实际需求可以打开一些程序或库的&lt;code&gt;debug&lt;/code&gt;选项，方便gdb进行跟踪。比如&lt;code&gt;test_eval_expression&lt;/code&gt;程序，修改libs/sgeobj/Makefile下面这行：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;test_eval_expression&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;test_eval_expression&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;o&lt;/span&gt; &lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SGEOBJLIB&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SGEOBJDLIB&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;CULLLIB&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;UTILIB&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;WINGRIDLIB_DEP …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yang Liping</dc:creator><pubDate>Sat, 25 Apr 2020 15:30:46 +0800</pubDate><guid isPermaLink="false">tag:www.yanglp.com,2020-04-25:/posts/2020/04/25/python-import-sgeku-wen-jian.html</guid><category>Tech</category><category>python</category><category>sge</category></item><item><title>mvcli导致大量zfs vdev.bad_ashift日志</title><link>http://www.yanglp.com/posts/2019/12/18/mvclidao-zhi-da-liang-zfs-vdevbad_ashiftri-zhi.html</link><description>&lt;h3&gt;发现问题&lt;/h3&gt;
&lt;p&gt;上周从每天的日志统计日报发现，突然部分存储服务器开始大量出现类似以下的日志：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;Dec&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;59&lt;/span&gt; &lt;span class="n"&gt;myserver&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;17475246.696258&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="n"&gt;sdal&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sdal1&lt;/span&gt; &lt;span class="n"&gt;sdal9&lt;/span&gt;
&lt;span class="n"&gt;Dec&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;59&lt;/span&gt; &lt;span class="n"&gt;myserver&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sdal&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sdal1&lt;/span&gt; &lt;span class="n"&gt;sdal9&lt;/span&gt;
&lt;span class="n"&gt;Dec&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt; &lt;span class="n"&gt;myserver&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;17475246.882323&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="n"&gt;sdam&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sdam1&lt;/span&gt; &lt;span class="n"&gt;sdam9&lt;/span&gt;
&lt;span class="n"&gt;Dec&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt; &lt;span class="n"&gt;myserver&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sdam&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sdam1&lt;/span&gt; &lt;span class="n"&gt;sdam9&lt;/span&gt;
&lt;span class="n"&gt;Dec&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="mi"&gt;15 …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yang Liping</dc:creator><pubDate>Wed, 18 Dec 2019 10:59:44 +0800</pubDate><guid isPermaLink="false">tag:www.yanglp.com,2019-12-18:/posts/2019/12/18/mvclidao-zhi-da-liang-zfs-vdevbad_ashiftri-zhi.html</guid><category>Tech</category><category>zfs</category></item><item><title>DNS的ALIAS和ANAME记录</title><link>http://www.yanglp.com/posts/2014/04/16/dnsde-aliashe-anameji-lu.html</link><description>&lt;p&gt;对于有配置过DNS的人，一般都知道DNS的A、CNAME、MX这样的记录，但是不一定大家都知道ALIAS和ANAME记录。那么这两个记录到底是什么意思呢？这两个分别是DNSimple和DNS Made Easy两个域名注册商针对Paas应用的一条特别的记录，相当顶级域名(root/base/apex domain, or top level domain)的CNAME。&lt;/p&gt;
&lt;p&gt;创建&lt;a href="https://zh.wikipedia.org/wiki/PaaS"&gt;PaaS&lt;/a&gt;(Platform-as-a-Service: 平台即服务)应用的时候，我们经常会使用自定义域名。这时候我们一般会用CNAME把自己的域名指向PaaS提供的一个域名。而这个域名一般是会有智能DNS解析，会把离用户最近的&lt;a href="https://zh.wikipedia.org/wiki/%E5%85%A7%E5%AE%B9%E5%82%B3%E9%81%9E%E7%B6%B2%E8%B7%AF"&gt;CDN&lt;/a&gt;(Content Delivery Network 内容分发网络)服务器IP返回给用户，提高访问速度。这样无论用户在世界哪个角度，都能获得比较理想的访问速度。例如把应用放在Amazon上，然后把自己注册的域名www.xxx.com指向Amazon提供的域名，然后用户访问www.xxx.com域名，实际服务由Amazon提供。这样很好很强大，对吧？那如果我们想把xxx.com也指向Amazon的应用呢？加一条xxx …&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yang Liping</dc:creator><pubDate>Wed, 16 Apr 2014 15:59:43 +0800</pubDate><guid isPermaLink="false">tag:www.yanglp.com,2014-04-16:/posts/2014/04/16/dnsde-aliashe-anameji-lu.html</guid><category>Tech</category><category>DNS</category></item><item><title>VIM (0) - 返回到最初打开文档的状态</title><link>http://www.yanglp.com/posts/2014/04/15/vim-0-fan-hui-dao-zui-chu-da-kai-wen-dang-de-zhuang-tai.html</link><description>&lt;p&gt;在VIM中编辑文档，有时候需要撤销所有修改，恢复文档到最初的状态。这时候，我们可以一般是连续按&lt;code&gt;u&lt;/code&gt;恢复到最初的状态。但如果已经修改了很多次的话，那就太麻烦了，下面是一些更简捷的方法。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;用&lt;code&gt;:u1|u&lt;/code&gt;返回最初状态，再按&lt;code&gt;u&lt;/code&gt;的话状态栏会显示“Already at oldest change”，表示文档已经在最初状态。&lt;code&gt;u1&lt;/code&gt;的意思是返回到修改号1(change number 1)之后，&lt;code&gt;|&lt;/code&gt;不是shell中的管道，而是多个命令的分割符，所以&lt;code&gt;|u&lt;/code&gt;的意思是再做一次undo。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;用&lt;code&gt;:earlier 10000000&lt;/code&gt;，10000000是一个尽量大的数，这个命令的意思是返回10000000次修改以前的状态。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;用&lt;code&gt;10000000g-&lt;/code&gt;，这个命令跟上面的&lt;code&gt;:earlier 10000000&lt;/code&gt;是一样的意思，但是是在普通模式下输入。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果文档还没有保存的话，我们可以用&lt;code&gt;:q!&lt;/code&gt;退出编辑，然后重新打开文档 …&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yang Liping</dc:creator><pubDate>Tue, 15 Apr 2014 13:26:29 +0800</pubDate><guid isPermaLink="false">tag:www.yanglp.com,2014-04-15:/posts/2014/04/15/vim-0-fan-hui-dao-zui-chu-da-kai-wen-dang-de-zhuang-tai.html</guid><category>Tech</category><category>vim</category></item></channel></rss>